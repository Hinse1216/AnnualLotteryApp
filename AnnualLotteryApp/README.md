# 年会抽奖应用（WPF）

一个基于 WPF 的年会抽奖小工具，支持自定义标题、奖项配置、导入参与人员名单以及实时展示中奖结果。

## 功能说明

- 支持导入文本格式的抽奖人员名单（每行一个姓名）
- 支持自定义抽奖标题和奖项配置
- 支持按奖项分轮次抽奖，并避免同一人员重复中奖
- 提供抽奖大屏展示界面和中奖墙展示界面
- 抽奖结果实时追加写入本地 `data/result.csv`，防止意外退出导致数据丢失
- 支持一键恢复默认配置并清空历史中奖记录

## 运行环境

- .NET Framework 4.8

使用 Visual Studio 打开解决方案并运行 `AnnualLotteryApp` 项目即可。

## 使用步骤

1. 启动程序后，可在主界面查看当前标题和奖项列表。
2. 如需自定义标题和奖项人数，可编辑 `data/data.conf`（不存在时可通过“恢复默认”自动生成）：
   - `Title=xxxx` 用于设置窗口标题，例如：`Title=2026 公司年会抽奖`。
   - 其他行用于配置奖项及应抽人数，例如：`一等奖=3`、`幸运奖=20`。
3. 导入抽奖人员名单（可选）：
   - 在主界面点击“导入”，选择一个 `.txt` 文件。
   - 文件中每行一个姓名，空行和全空白行会被忽略。
4. 打开奖项大屏：
   - 在主界面点击“抽奖大屏”按钮，打开全屏抽奖页面。
5. 选择需要抽取的奖项和人数：
   - 在主界面选择当前奖项，若在 `data.conf` 中配置了人数，将自动带出到抽取人数；
   - 也可以在界面中手动调整当前轮的抽取人数。

## 抽奖快捷键

在抽奖大屏窗口中可以通过快捷键控制抽奖流程：

1. 按 `Ctrl + 1` 开始抽奖（开始滚动姓名）。
2. 按 `Ctrl + 2` 或空格键 停止抽奖（生成本轮中奖名单）。

## 抽奖结果

- 每次停止抽奖后，本轮新产生的中奖记录会立即追加写入：`data/result.csv`。
  - 默认表头为：`奖项,姓名,中奖时间`。
  - 若文件不存在会自动创建。
- 在主界面可以通过“导出结果”将 `result.csv` 复制到指定位置，文件名类似：`年会抽奖结果_yyyyMMdd_HHmmss.csv`。
- 在主界面可以通过“查看全部中奖名单”按钮弹窗查看当前所有中奖记录。

## 恢复默认配置

主界面提供“恢复默认”功能，点击后会：

- 重置标题为：`2026 公司年会抽奖`；
- 重置默认奖项列表及人数配置：
  - 特等奖=1
  - 一等奖=3
  - 二等奖=5
  - 三等奖=10
  - 幸运奖=20
- 清空当前所有中奖记录和当前轮中奖结果；
- 覆盖写入 `data/data.conf` 为默认配置；
- 删除本地 `data/result.csv` 文件。

> 注意：恢复默认会清空历史中奖数据，请谨慎操作。